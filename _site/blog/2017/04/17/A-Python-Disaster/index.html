<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width">
	<title>Franco A. Alvarado > A Python Disaster</title>
	<link rel="stylesheet" href="/css/screen.css" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89146983-2', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body><!-- 
<script>
document.body.className += ' fade-out';
</script>
 -->
<nav class="topnav">
	<div id="logo">
		<a href="/">
			<img src="/img/franco-image.jpg" alt="" />
			<div class="logo-overlay"></div>
		</a>
	</div>
	<input type="checkbox" id="show-menu" role="button">
	<label for="show-menu" class="show-menu"><i class="fa fa-navicon" aria-hidden="true"></i> Menu</label>
	<ul id="menu">
		<li id="name"> <span data-title="">Franco A. Alvarado</span></a></li>
		<li><a href="mailto:&#102;&#114;&#097;&#110;&#099;&#111;&#102;&#097;&#097;&#064;&#103;&#109;&#097;&#105;&#108;&#046;&#099;&#111;&#109;?subject=&#073;&#032;&#097;&#109;&#032;&#097;&#032;&#114;&#111;&#098;&#111;&#116;"><i class="fa fa-commenting-o" aria-hidden="true"></i><span data-title="Contact"> Contact Me</span></a></li>		
<!--  		<li id="contactme"><i class="fa fa-comments" aria-hidden="true"></i><span data-title="Contact Me"> Contact Me</span></li> -->
<!-- 		<li><a href="mailto:&#102;&#114;&#097;&#110;&#099;&#111;&#102;&#097;&#097;&#064;&#103;&#109;&#097;&#105;&#108;&#046;&#099;&#111;&#109;&subject=&#073;&#032;&#097;&#109;&#032;&#097;&#032;&#114;&#111;&#098;&#111;&#116;"><i class="fa  fa-commenting-o" aria-hidden="true"></i><span data-title="Contact Me"> Contact Me</span></li> -->
		<li><a href="/experience"><i class="fa fa-cubes" aria-hidden="true"></i><span data-title="Experience"> Experience</span></a></li>
		<!-- <li><a href="/#services"><i class="fa fa-handshake-o" aria-hidden="true"></i><span data-title="Services"> Services</span></a></li> -->
		<li><a href="/#projectpane"><i class="fa fa-archive" aria-hidden="true"></i><span data-title="Projects"> Portfolio</span></a></li>		
	</ul>
</nav>


<article class="blogpost">
	<header>
		<h1 class="post-title">A Python Disaster</h1>
		
		
		<p class="byline">17 April 2017 |   
			 
				 
					<!--<a href="#python" class="post-tag">--> <b>Python | </b> <!--</a>-->
  				 
					<!--<a href="#pandoc" class="post-tag">--> <b>Pandoc | </b> <!--</a>-->
  				 
					<!--<a href="#regular-expressions" class="post-tag">--> <b>Regular Expressions | </b> <!--</a>-->
  				
  			 
  		Franco A. Alvarado</p>
	</header>
	<section>
		<p>I had 30 docx files, each between 300 and 400 pages long (so between 9,000 and 12,000 pages total), with random headings thrown in and also bolded text that is supposed to be a heading but is, of course, like most things in life, completely without style. </p>

<p>My boss asked me to go through and apply heading styles <em>only</em> to the bolded text, and otherwise remove the stylings applied.</p>

<p>So, I could’ve gone in and done this manually, opened each of the 30 files and done a find and replace and apply style. OR: </p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/34/Hatchling_Python_sebae_Tropicario%2C_FIN_2.jpg/320px-Hatchling_Python_sebae_Tropicario%2C_FIN_2.jpg" alt="A photo of a python (the animal, not the programming language)" />
<strong>Python time! (The age of this python is a metaphor for my current abilities with the programming language. By Tigerpython (Own work) <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY-SA 3.0</a>, via Wikimedia Commons)</strong></p>

<p>It took longer to make and run the script than it would’ve to have done it all manually (mostly because I made little errors). </p>

<p>And here’s the script:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">pypandoc</span><span class="o">,</span> <span class="nn">re</span>

<span class="n">curDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">curDir</span><span class="p">):</span> 
	<span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.docx&#39;</span><span class="p">):</span>
		<span class="n">fileName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="nb">file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">output</span> <span class="o">=</span> <span class="n">pypandoc</span><span class="o">.</span><span class="n">convert_file</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s">&#39;md&#39;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s">&quot;-FA.md&quot;</span><span class="p">)</span>
		<span class="k">print</span> <span class="nb">file</span> <span class="o">+</span> <span class="s">&quot; has been converted to markdown&quot;</span>
        <span class="c">#left myself console notes so I knew where I was; </span>
        <span class="c">#like I said, this script took a really long time to run</span>

<span class="k">for</span> <span class="n">mdFile</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">curDir</span><span class="p">):</span> 
	<span class="k">if</span> <span class="n">mdFile</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.md&#39;</span><span class="p">):</span>
	    <span class="c">#now we have our markdown files,</span>
    	<span class="c">#which are a little easier to parse than docx</span>
		<span class="n">mdFileName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">mdFile</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">mdFile_opened</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">mdFile</span><span class="p">)</span>
		<span class="n">mdFile_contents</span> <span class="o">=</span> <span class="n">mdFile_opened</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
		<span class="n">mdFile_opened</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">mdFile</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
		<span class="n">regex</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">\*\*(.*?)\*\*</span><span class="se">\n</span><span class="s">&quot;</span>
		<span class="n">subst</span> <span class="o">=</span> <span class="s">r&quot;\n# \1\n&quot;</span>
		<span class="n">mdFile_contents</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">subst</span><span class="p">,</span> <span class="n">mdFile_contents</span><span class="p">)</span>
        <span class="c">#replace bolded text on its own line</span>
        <span class="c">#with h1&#39;s on their own lines</span>
		<span class="n">mdFile_opened</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mdFile_contents</span><span class="p">)</span>
		<span class="n">mdFile_opened</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">print</span> <span class="s">&quot;Headings inside of &quot;</span> <span class="o">+</span> <span class="n">mdFile</span> <span class="o">+</span> <span class="s">&quot; adjusted!&quot;</span>
        
		<span class="n">revertdocx</span> <span class="o">=</span> <span class="n">pypandoc</span><span class="o">.</span><span class="n">convert_file</span><span class="p">(</span><span class="n">mdFile</span><span class="p">,</span> <span class="s">&#39;docx&#39;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span> <span class="n">mdFileName</span> <span class="o">+</span> <span class="s">&quot;.docx&quot;</span><span class="p">)</span>
		<span class="k">print</span> <span class="n">mdFile</span> <span class="o">+</span> <span class="s">&quot;converted back to DOCX&quot;</span></code></pre></div>

<p>Not sure where it goes wrong, but it does go wrong. It ran for 20 minutes (thankfully giving me updates of its process due to the helpful print to console commands I put in there). After the script stalled out on one of the files, I stopped and went with a manual approach. It was actually faster than I thought find/replacing on bold and applying H1, and then promoting and demoting headings to appropriately nest them. Only took like 10 hours. No big deal. Most of that time was spent wondering whether something was a sub-section of another.</p>

<p>Moral of the story: Make authors and editors determine heading hierarchy.</p>

	</section>
		<aside class="bio">
	<h2>Franco A. Alvarado 
		    | <a href="https://twitter.com/NoFrancosPlease">
		      <i class="fa fa-twitter"></i> 
		    </a>
		
		
		    | <a href="https://github.com/francofaa">
		      <i class="fa fa-github"></i> 
		    </a>
		
		
		    | <a href="https://linkedin.com/in/franco-alvarado-17959124">
		      <i class="fa fa-linkedin"></i> 
		    </a>
		</h2>
	<p>I currently work in publishing, mostly ebook development and print production. I am learning full stack web development and working on my first novel. I&#8217m interested in the space where digital and publishing meet, mostly to make my work faster and more efficient and to deliver content in new and interesting ways. This blog documents everything related to the many projects I am working on.</p>
</aside>
</article>
<div class="PageNavigation">

  
</div>
<div id="blog-roll">
	
	  
	  	<div class="post">
			<h3 class="title"><a href="/blog/2017/05/22/Painting/">Painting</a></h3>
				<p class="meta">22 May 2017 |   
			 
				 
					<!--<a href="#painting" class="post-tag">--> 
						<b>Painting | </b> <!--</a>-->
  				 
					<!--<a href="#podcasting" class="post-tag">--> 
						<b>Podcasting | </b> <!--</a>-->
  				
  			 
  		Franco A. Alvarado</p>
				<p>
					This one was going to be about maps, but I accidentally painted a painting! Isn't that fun? So as not to keep you in suspense, here it is:


				</p>

		</div>
	  
	
	  
	  	<div class="post">
			<h3 class="title"><a href="/blog/2017/05/15/Resets/">Resets</a></h3>
				<p class="meta">15 May 2017 |   
			 
				 
					<!--<a href="#meta" class="post-tag">--> 
						<b>Meta | </b> <!--</a>-->
  				 
					<!--<a href="#organization" class="post-tag">--> 
						<b>Organization | </b> <!--</a>-->
  				
  			 
  		Franco A. Alvarado</p>
				<p>
					I believe I am still adjusting to this new way of working, this new way of living. I had a very productive weekend at the very least. I turned the kitchen island 90 degrees. It separates the space in a more pleasing way. My fianceé had realized that we had just created another galley kitchen by having the kitchen island parallel to the sink / oven / countertop. It's a strange looking layout to be honest, but I tested it out today when I cooked three different meals at the same time. I made a chicken tikka masala, eggplant pasta, and pesto. Cooked for the week so I can also get back on my workout schedule.


				</p>

		</div>
	  
	
	  
	  	<div class="post">
			<h3 class="title"><a href="/blog/2017/05/08/Overload/">Overload</a></h3>
				<p class="meta">08 May 2017 |   
			 
				 
					<!--<a href="#meta" class="post-tag">--> 
						<b>Meta | </b> <!--</a>-->
  				 
					<!--<a href="#writing" class="post-tag">--> 
						<b>Writing | </b> <!--</a>-->
  				
  			 
  		Franco A. Alvarado</p>
				<p>
					I had a lot of freelance work to do this week. It made me think about whether I should quit doing this blog, but then I realized that it's probably fine. It's more like a check-in for myself and my projects. Someone might stumble upon this, but it's not adding anything terribly interesting just yet to the discussion of the different topics I'd like to get into.


				</p>

		</div>
	  
	
	  
	  	<div class="post">
			<h3 class="title"><a href="/blog/2017/05/01/Project-Rotation/">Project Rotation</a></h3>
				<p class="meta">01 May 2017 |   
			 
				 
					<!--<a href="#python" class="post-tag">--> 
						<b>Python | </b> <!--</a>-->
  				 
					<!--<a href="#jekyll" class="post-tag">--> 
						<b>Jekyll | </b> <!--</a>-->
  				 
					<!--<a href="#meta" class="post-tag">--> 
						<b>Meta | </b> <!--</a>-->
  				
  			 
  		Franco A. Alvarado</p>
				<p>
					I have extra-curricular projects I like to work on, in additon to projects at work where I am a project manager and my freelance projects (which I am careful to make sure are never a conflict of interest, in case you were wondering). The projects can include any of the following:


				</p>

		</div>
	  
	
	  
	  	<div class="post">
			<h3 class="title"><a href="/blog/2017/04/24/Organizing-Metadata-in-YAML/">Organizing Metadata in YAML</a></h3>
				<p class="meta">24 April 2017 |   
			 
				 
					<!--<a href="#yaml" class="post-tag">--> 
						<b>YAML | </b> <!--</a>-->
  				 
					<!--<a href="#metadata" class="post-tag">--> 
						<b>Metadata | </b> <!--</a>-->
  				
  			 
  		Franco A. Alvarado</p>
				<p>
					I have organized a large amount of content into a YAML document. This will aid in the [contact automation](../Automating-Contracts) I was talking about before. For the encyclopedia project I am working on, there are topics and entries. The editors relay to me the author's information and what topic they will be writing about, which I am to cross-reference with a set of three documents. 


				</p>

		</div>
	  
	
	  
	  	<div class="post">
			<h3 class="title"><a href="/blog/2017/04/17/A-Python-Disaster/">A Python Disaster</a></h3>
				<p class="meta">17 April 2017 |   
			 
				 
					<!--<a href="#python" class="post-tag">--> 
						<b>Python | </b> <!--</a>-->
  				 
					<!--<a href="#pandoc" class="post-tag">--> 
						<b>Pandoc | </b> <!--</a>-->
  				 
					<!--<a href="#regular-expressions" class="post-tag">--> 
						<b>Regular Expressions | </b> <!--</a>-->
  				
  			 
  		Franco A. Alvarado</p>
				<p>
					I had 30 docx files, each between 300 and 400 pages long (so between 9,000 and 12,000 pages total), with random headings thrown in and also bolded text that is supposed to be a heading but is, of course, like most things in life, completely without style. 


				</p>

		</div>
	  
	
	  
	  	<div class="post">
			<h3 class="title"><a href="/blog/2017/04/10/Yet-Another-Scheduling-Jekyll-Posts-Post/">Yet another scheduling Jekyll posts post</a></h3>
				<p class="meta">10 April 2017 |   
			 
				 
					<!--<a href="#jekyll" class="post-tag">--> 
						<b>Jekyll | </b> <!--</a>-->
  				 
					<!--<a href="#python" class="post-tag">--> 
						<b>Python | </b> <!--</a>-->
  				 
					<!--<a href="#meta" class="post-tag">--> 
						<b>Meta | </b> <!--</a>-->
  				
  			 
  		Franco A. Alvarado</p>
				<p>
					I’ve been trying to research how to schedule these Jekyll blog posts so I am one of those great Internet unicorns that regularly updates their blog. If you don’t know, Jekyll is a static site generator, but it is pretty involved in its setup. 


				</p>

		</div>
	  
	
	  
	  	<div class="post">
			<h3 class="title"><a href="/blog/2017/04/03/Automating-Contracts/">Automating contracts</a></h3>
				<p class="meta">03 April 2017 |   
			 
				 
					<!--<a href="#latex" class="post-tag">--> 
						<b>LaTeX | </b> <!--</a>-->
  				 
					<!--<a href="#pandoc" class="post-tag">--> 
						<b>Pandoc | </b> <!--</a>-->
  				 
					<!--<a href="#docx" class="post-tag">--> 
						<b>docx | </b> <!--</a>-->
  				
  			 
  		Franco A. Alvarado</p>
				<p>
					I have to juggle multiple authors and their contracts, so I thought it’d be better to automate those contracts so I can prevent errors and have uniformity throughout. Ideal workflow:


				</p>

		</div>
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
	  
	
</div>

<!-- <div id="form-container">
<h1>Keep in touch!</h1>
<form method="POST" action="http://formspree.io/franco.faa@gmail.com">
	<input type="text" name="_replyto" placeholder="Your email" />
	<textarea name="message" placeholder="Your message"></textarea>
	<input type="text" name="_gotcha" style="display:none;" />
	<input type="hidden" name="_next" value="/thanks" />
	<button class="formbutton" type="submit">Send</button>
</form>
</div> -->
<footer>
	<p class="copyright">Site built by Franco A. Alvarado &copy; 2017. <a href="https://github.com/francofaa/francofaa.github.io">Site source</a>
		
	 | <a href="https://twitter.com/NoFrancosPlease">
		      <i class="fa fa-twitter"  aria-hidden="true"></i> 
		    </a>
		
		
		    | <a href="https://github.com/francofaa">
		      <i class="fa fa-github-alt"  aria-hidden="true"></i> 
		    </a>
		
		
		    | <a href="https://linkedin.com/in/franco-alvarado-17959124">
		      <i class="fa fa-linkedin" aria-hidden="true"></i> 
		    </a>
		 
			| <a href="http://www.francoalvarado.com/blog">
				<i class="fa fa-pencil" aria-hidden="true"></i> blog
		    </a>
		</p>
</footer>
<script src="/js/jquery-2.1.1.min.js"></script>
<script>
	$(function() {  
  var shiftWindow = function() { scrollBy(0, -135) };
  window.addEventListener("hashchange", shiftWindow);
  function load() { if (window.location.hash) shiftWindow(); }
  // contact form animations
  $('#contactme').click(function() {
    $('#form-container').fadeToggle();
  })
  $(document).mouseup(function (e) {
    var container = $("#form-container");

    if (!container.is(e.target) // if the target of the click isn't the container...
        && container.has(e.target).length === 0) // ... nor a descendant of the container
    {
        container.fadeOut();
    }
  });
});
  
function openNav() {
    document.getElementById("mySidenav").style.width = "250px";
}

function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
}
// $(function() {
//     $('body').removeClass('fade-out');
// });
</script>
</body>
</html>